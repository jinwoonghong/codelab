# Pull Request: Phase 2 - 특수 블록 & 환경 변수

## 📋 개요

타워 스태커 게임의 **Phase 2 (특수 블록 & 환경 변수)**를 구현하여 게임에 다양성과 전략성을 추가했습니다.

## ✨ 주요 변경사항

### 1. 특수 블록 시스템 구현

#### 🔗 접착 블록 (Adhesive Block)
- **색상**: 노란색 (0xFFD93D) + 🔗 아이콘
- **효과**: 착지 시 주변 100px 이내 블록과 2초간 물리적으로 접착
- **구현**: Matter.js의 constraint를 사용하여 블록 간 연결
- **전략**: 불안정한 타워를 안정화시키는데 유용

#### ⚽ 고무 블록 (Rubber Block)
- **색상**: 핑크색 (0xFF6B9D) + ⚽ 아이콘
- **효과**: 반발력 0.9로 높게 튕김
- **마찰력**: 0.3으로 낮춰 미끄러움
- **전략**: 충격 흡수 효과가 있지만 불안정

#### ⚡ 가속 블록 (Speed Block)
- **색상**: 빨간색 (0xFF5733) + ⚡ 아이콘
- **효과**: 밀도 2배로 빠르게 낙하
- **보너스**: 성공 시 +50점 추가 점수
- **시각 효과**: 골드 색상의 보너스 텍스트 애니메이션

#### 💎 유리 블록 (Glass Block)
- **색상**: 하늘색 (0xA8DADC, 60% 투명도) + 💎 아이콘
- **효과**: 매우 가벼움 (밀도 0.0005)
- **특수 기능**: 속도가 임계값 이상이면 깨짐
- **내구도**: Health 3 (충돌 3회 후 파괴)
- **시각 효과**: 깨질 때 12개의 파편이 흩어지는 애니메이션

#### 📊 특수 블록 등장 시스템
- **확률**: 20% (GameConfig에서 조정 가능)
- **선택**: 4가지 특수 블록 중 랜덤
- **일반 블록**: 80% 확률로 기존 컬러 블록

### 2. 환경 변수 시스템 구현

#### 💨 돌풍 효과 (Wind Effect)
- **발동 조건**: 타워 높이 20m 이상, 0.2% 확률
- **효과**: 모든 블록에 좌우 방향 물리적 힘 적용 (3초간)
- **시각 효과**:
  - 5개의 바람 라인이 화면을 가로지름
  - 라인이 바람 방향으로 이동하는 애니메이션
- **전략**: 타워가 흔들리므로 조심해야 함

#### 🌍 중력 변화 (Gravity Change)
- **발동 조건**: 타워 높이 30m 이상, 0.1% 확률
- **효과**: 중력이 1.5배 또는 0.5배로 변화 (5초간)
- **시각 효과**: 화면 흔들림 (shake) 효과
- **전략**:
  - 중력 증가: 블록이 빠르게 떨어짐
  - 중력 감소: 블록이 천천히 떨어짐

### 3. 시각 효과 시스템

#### 🎨 파티클 효과
- 특수 블록 착지 시 방사형 파티클 효과
- 블록 색상에 맞춘 8개 파티클이 퍼지며 사라짐

#### ✨ 보너스 텍스트 애니메이션
- 가속 블록 성공 시 "+50" 골드 텍스트
- 위로 올라가며 페이드 아웃

#### 💥 깨짐 효과
- 유리 블록 파괴 시 12개 파편 흩어짐
- 각 파편이 회전하며 날아가는 애니메이션

## 🎮 핵심 기능

✅ **4가지 특수 블록** - 각각 독특한 물리 속성과 전략
✅ **2가지 환경 변수** - 예측 불가능한 게임 플레이
✅ **다양한 시각 효과** - 몰입감 있는 게임 경험
✅ **아이콘 시스템** - 블록 타입을 직관적으로 표시
✅ **블록-아이콘 동기화** - 물리 바디와 완벽하게 동기화

## 🧪 테스트 방법

```bash
cd projects/tower-stacker
npm install
npm run dev
# 브라우저에서 http://localhost:3000 열기
```

**테스트 항목**:
1. ✅ 특수 블록이 20% 확률로 등장하는지 확인
2. ✅ 접착 블록이 주변 블록과 연결되는지 확인
3. ✅ 고무 블록이 높게 튕기는지 확인
4. ✅ 가속 블록이 빠르게 떨어지고 보너스 점수를 주는지 확인
5. ✅ 유리 블록이 충격에 깨지는지 확인
6. ✅ 높이 20m 이상에서 돌풍 효과 발동 확인
7. ✅ 높이 30m 이상에서 중력 변화 효과 확인

## 📊 진행 상황

- [x] Phase 1: 핵심 게임 루프
- [x] Phase 2: 특수 블록 & 환경 변수 (현재 PR)
  - [x] 접착 블록
  - [x] 고무 블록
  - [x] 가속 블록
  - [x] 유리 블록
  - [x] 돌풍 효과
  - [x] 중력 변화
  - [x] 시각 효과
  - [ ] 방해 드론 (향후 추가 예정)
- [ ] Phase 3: 게임 모드 (타임 어택, 일일 도전, 퍼즐)
- [ ] Phase 4: 성장 시스템 (코인, 스킨, 업적)
- [ ] Phase 5: 소셜 기능 (챌린지 코드, 고스트, GIF)

## 📂 변경된 파일

- `src/scenes/GameScene.js` - 특수 블록 및 환경 변수 시스템 구현 (600+ 라인)
  - `determineBlockType()` - 블록 타입 결정
  - `getBlockInfo()` - 블록 정보 정의
  - `applySpecialBlockEffect()` - 특수 블록 효과 적용
  - `applyAdhesiveEffect()` - 접착 블록 로직
  - `checkGlassBlockDamage()` - 유리 블록 깨짐 감지
  - `breakGlassBlock()` - 유리 블록 파괴 처리
  - `checkEnvironmentalEffects()` - 환경 변수 발동 조건 체크
  - `triggerWindEffect()` - 돌풍 효과
  - `triggerGravityChange()` - 중력 변화
  - `createParticleEffect()` - 파티클 효과
  - `createShatterEffect()` - 깨짐 효과
  - `createWindEffect()` - 바람 시각 효과
  - `showBonusText()` - 보너스 텍스트 표시

## 🔍 리뷰 포인트

1. **특수 블록 밸런스**: 각 블록의 물리 속성이 적절한가?
2. **시각 효과**: 이펙트가 게임 플레이를 방해하지 않는가?
3. **환경 변수 난이도**: 돌풍과 중력 변화가 너무 어렵지 않은가?
4. **코드 구조**: 특수 블록 시스템이 확장 가능하게 설계되었는가?
5. **성능**: 파티클 효과가 프레임 드롭을 일으키지 않는가?

## 🎯 다음 단계

Phase 3에서는 다음 기능을 구현할 예정입니다:
- 타임 어택 모드 (90초 제한)
- 일일 도전 모드 (시드 기반 고정 블록 순서)
- 퍼즐 모드 (스테이지 시스템)
- 방해 드론 추가 (Phase 2 미완료 항목)

## 💡 기술적 하이라이트

### Matter.js Constraint 활용
접착 블록은 Matter.js의 constraint 시스템을 활용하여 블록 간 물리적 연결을 구현했습니다.

```javascript
const constraint = this.matter.add.constraint(
    block.body,
    nearbyBlock.body,
    0, // 거리
    0.05 // 강도
);
```

### 동적 블록 시스템
블록 타입에 따라 다른 물리 속성과 효과를 적용할 수 있는 확장 가능한 시스템을 구축했습니다.

### 파티클 시스템
Phaser의 Tween 시스템을 활용하여 부드러운 파티클 애니메이션을 구현했습니다.
